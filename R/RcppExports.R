##
## wdnet: Weighted directed network
## Copyright (C) 2021  Yelie Yuan, Panpan Zhang, and Jun Yan
## Jun Yan <jun.yan@uconn.edu>
##
## This file is part of the R package wdnet.
##
## The R package wdnet is free software: You can redistribute it and/or
## modify it under the terms of the GNU General Public License as published by
## the Free Software Foundation, either version 3 of the License, or any later
## version (at your option). See the GNU General Public License at
## <https://www.gnu.org/licenses/> for details.
##
## The R package wdnet is distributed in the hope that it will be useful,
## but WITHOUT ANY WARRANTY without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
##

# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

hello_world <- function() {
    invisible(.Call(`_wdnet_hello_world`))
}

fx <- function(x, Y, z) {
    .Call(`_wdnet_fx`, x, Y, z)
}

#' Degree preserving rewiring process for directed networks.
#'
#' @param targetNode Target node sequence.
#' @param index_s Index sequence of source nodes' out- and in-degree. 
#'   index_s and index_t bridge the source/target node's and the 
#'   joint degree distribution matrix joint_e.
#' @param index_t Index sequence of target nodes' out- and in-degree. 
#' @param nattempts Integer, number of rewiring attempts.
#' @param joint_e Matrix, target joint distribution generated by
#'   wdnet::directed_edge_level_dist().
#' @return Target node sequence and number of 
#'   accepted rewiring attempts.
#'
directed_rewire_cpp <- function(targetNode, index_s, index_t, nattempts, joint_e) {
    .Call(`_wdnet_directed_rewire_cpp`, targetNode, index_s, index_t, nattempts, joint_e)
}

#' Degree preserving rewiring process for undirected networks.
#'
#' @param node_s Node sequence of the first column of edgelist.
#' @param node_t Node sequence of the second column of edgelist.
#' @param index_s Index sequence of the first column of edgelist. 
#'   index_s and index_t bridge the nodes' degree and the 
#'   edge-level distribution e.
#' @param index_t Index sequence of the second column of edgelist.
#' @param nattempts Integer, number of rewiring attempts.
#' @param e Matrix, target edge-level distribution generated by
#'   wdnet::undirected_edge_level_dist().
#' @return Node sequences, node indexes and number of 
#'   accepted rewiring attempts.
#'
undirected_rewire_cpp <- function(node_s, node_t, index_s, index_t, nattempts, e) {
    .Call(`_wdnet_undirected_rewire_cpp`, node_s, node_t, index_s, index_t, nattempts, e)
}

#' Fill missing values in node sequence.
#'
#' @param nodes Sequence of source/target node of edges, missing values are denoted as 0.
#' @param edges Edges sampled according to preferential attachment.
#' @param index Index of missing values in nodes.
#' @return Sequence of source/target node of edges.
findNode_cpp <- function(nodes, edges, index) {
    .Call(`_wdnet_findNode_cpp`, nodes, edges, index)
}

#' Aggregate edgeweight into nodes' strength.
#'
#' @param startNode Sequence of source nodes.
#' @param endNode Sequence of target nodes.
#' @param weight Sequence of edgeweight.
#' @param nNodes Number of nodes of sampled network.
#' @param weighted Logical, ture if the edges are weighted, 
#'   false if not.
#' @return Sequence of outstrength/instrength.
nodeStrength_cpp <- function(startNode, endNode, weight, nNodes, weighted = TRUE) {
    .Call(`_wdnet_nodeStrength_cpp`, startNode, endNode, weight, nNodes, weighted)
}

#' Sample nodes with respect to the number of nodes at each step.
#'
#' @param totalNode Number of nodes at each step.
#' @return Sequence of sampled nodes.
sampleNode_cpp <- function(totalNode) {
    .Call(`_wdnet_sampleNode_cpp`, totalNode)
}

#' Preferential attachment algorithm for simple situations, 
#' e.g., edge weights are constant, 
#' number of new edges per step is 1.
#'
#' @param startNode Sequence of source nodes.
#' @param endNode Sequence of target nodes.
#' @param scenario Sequence of alpha, beta, gamma, xi, rho scenarios.
#' @param nNodes Number of nodes at current step.
#' @param nEdges Number of edges at current step.
#' @param delta_out Tuning parameter.
#' @param delta_in Tuning parameter.
#' @return Number of nodes, sequences of source and target nodes.
#' 
rpanet_cpp <- function(startNode, endNode, scenario, nNodes, nEdges, delta_out, delta_in) {
    .Call(`_wdnet_rpanet_cpp`, startNode, endNode, scenario, nNodes, nEdges, delta_out, delta_in)
}

